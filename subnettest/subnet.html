<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generátor a kontrola IP adres</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            margin-bottom: 20px;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ccc;
            text-align: center;
        }
        th {
            background-color: #f4f4f4;
        }
        .valid {
            background-color: lightgreen;
        }
        .invalid {
            background-color: lightcoral;
        }
        .generate-btn, .check-btn {
            padding: 10px 20px;
            font-size: 16px;
            margin: 10px 0;
            cursor: pointer;
        }
        .message {
            font-weight: bold;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Generátor a kontrola IP adres</h1>

    <button class="generate-btn" onclick="generateSubnets()">Generovat subnety</button>
    <button class="check-btn" onclick="checkAnswers()">Kontrola</button>

    <!-- Tabulka pro zadávání údajů -->
    <table id="subnetsTable">
        <thead>
            <tr>
                <th>Subnet</th>
                <th>Počet hostů</th>
                <th>Prefix</th>
                <th>Adresa sítě</th>
                <th>Broadcast adresa</th>
            </tr>
        </thead>
        <tbody>
            <!-- Zde se budou přidávat řádky pro každý vygenerovaný subnet -->
        </tbody>
    </table>

    <!-- Zpráva pro uživatele -->
    <div id="message" class="message"></div>

    <script>
        let subnets = [];
        let networkRange = '172.16.0.0/16';  // Počáteční rozsah

        // Funkce pro generování subnetů a hostů
        function generateSubnets() {
            const numSubnets = Math.floor(Math.random() * 3) + 3;  // Minimálně 3 subnety
            const hostsTable = document.getElementById('subnetsTable').getElementsByTagName('tbody')[0];
            hostsTable.innerHTML = '';  // Vyprázdnění tabulky před generováním nových subnetů
            subnets = [];

            // Generování subnetů a počtu hostů
            for (let i = 0; i < numSubnets; i++) {
                const subnetLabel = String.fromCharCode(65 + i);  // A, B, C, D...
                const numHosts = Math.floor(Math.random() * 1000) + 1;  // Generování náhodného počtu hostů

                // Přidání subnetu do pole
                subnets.push({
                    label: subnetLabel,
                    hosts: numHosts
                });

                // Přidání řádku do tabulky pro každý subnet
                let row = hostsTable.insertRow();
                row.insertCell(0).textContent = subnetLabel;
                row.insertCell(1).textContent = numHosts;
                row.insertCell(2).innerHTML = `<input type="number" id="prefix_${i}" placeholder="Např. 24" value="24">`;
                row.insertCell(3).innerHTML = `<input type="text" id="network_${i}" placeholder="Např. 172.16.0.0/24">`;
                row.insertCell(4).innerHTML = `<input type="text" id="broadcast_${i}" placeholder="Např. 172.16.0.255">`;
            }
        }

        // Funkce pro kontrolu odpovědí uživatele
        function checkAnswers() {
            let message = document.getElementById('message');
            let allCorrect = true;
            message.textContent = '';  // Resetování zprávy

            // Projít každý subnet a zkontrolovat odpovědi
            subnets.forEach((subnet, i) => {
                const networkAddressInput = document.getElementById(`network_${i}`);
                const broadcastAddressInput = document.getElementById(`broadcast_${i}`);
                const prefixInput = document.getElementById(`prefix_${i}`);

                const userPrefix = parseInt(prefixInput.value);

                // Výpočet správného prefixu
                const calculatedPrefix = calculatePrefix(subnet.hosts);
                const network = `${networkRange.split('.')[0]}.${networkRange.split('.')[1]}.${networkRange.split('.')[2]}.${subnet.hosts * i}.0/${userPrefix}`;
                const broadcast = `${networkRange.split('.')[0]}.${networkRange.split('.')[1]}.${networkRange.split('.')[2]}.${subnet.hosts * i + 255}`;

                // Zkontrolovat, zda odpovědi odpovídají správným hodnotám
                let isNetworkCorrect = networkAddressInput.value === network;
                let isBroadcastCorrect = broadcastAddressInput.value === broadcast;
                let isPrefixCorrect = userPrefix === calculatedPrefix;

                // Zvýraznění odpovědí
                if (isNetworkCorrect) {
                    networkAddressInput.classList.add('valid');
                    networkAddressInput.classList.remove('invalid');
                } else {
                    networkAddressInput.classList.add('invalid');
                    networkAddressInput.classList.remove('valid');
                    allCorrect = false;
                }

                if (isBroadcastCorrect) {
                    broadcastAddressInput.classList.add('valid');
                    broadcastAddressInput.classList.remove('invalid');
                } else {
                    broadcastAddressInput.classList.add('invalid');
                    broadcastAddressInput.classList.remove('valid');
                    allCorrect = false;
                }

                if (isPrefixCorrect) {
                    prefixInput.classList.add('valid');
                    prefixInput.classList.remove('invalid');
                } else {
                    prefixInput.classList.add('invalid');
                    prefixInput.classList.remove('valid');
                    allCorrect = false;
                }
            });

            // Zpráva pro uživatele
            if (allCorrect) {
                message.textContent = "Vše je správně!";
            } else {
                message.textContent = "Některé hodnoty jsou nesprávné. Opravy: ";
            }
        }

        // Funkce pro výpočet správného prefixu na základě počtu hostů
        function calculatePrefix(numHosts) {
            let prefix = 32 - Math.ceil(Math.log2(numHosts + 2));  // +2 pro síťovou a broadcast adresu
            return prefix;
        }
    </script>
</body>
</html>
